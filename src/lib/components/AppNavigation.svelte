<script lang="ts">
import { onMount } from 'svelte';
import { browser } from '$app/environment';
import { s } from '$lib/client/localization.svelte';
import Tooltip from '$lib/components/Tooltip.svelte';
import { themeSettings } from '$lib/data/settings.svelte';

let isOpen = $state(false);
let navButtonRef: HTMLButtonElement = undefined!; // Assigned via bind:this
let navItemsRef: HTMLDivElement = undefined!; // Assigned via bind:this
let navLinks: HTMLAnchorElement[] = [];

// Menu items configuration - order matches Figma design
const menuItems = [
	{ id: 'search', href: 'https://kagi.com', labelKey: 'app_navigation.search' },
	{ id: 'assistant', href: 'https://kagi.com/assistant', labelKey: 'app_navigation.assistant' },
	{ id: 'divider' },
	{ id: 'news', href: 'https://news.kagi.com/', labelKey: 'app_navigation.news', active: true },
	{ id: 'translate', href: 'https://translate.kagi.com/', labelKey: 'app_navigation.translate' },
	{
		id: 'summarize',
		href: 'https://kagi.com/summarizer/index.html',
		labelKey: 'app_navigation.universal_summarizer',
	},
	{ id: 'smallweb', href: 'https://kagi.com/smallweb', labelKey: 'app_navigation.small_web' },
	{ id: 'fastgpt', href: 'https://kagi.com/fastgpt', labelKey: 'app_navigation.fastgpt' },
];

function toggleMenu() {
	isOpen = !isOpen;
}

const handleClickOutside = (event: MouseEvent) => {
	const dropdown = (event.target as Element).closest('.app-menu-dropdown');
	if (!dropdown || !dropdown.contains(event.target as Node)) {
		isOpen = false;
	}
};

const handleKeyDown = (event: KeyboardEvent) => {
	if (!isOpen) {
		// If menu is closed and Enter is pressed on the button, open it
		if (event.key === 'Enter' && document.activeElement === navButtonRef) {
			event.preventDefault();
			isOpen = true;
		}
		return;
	}

	// If menu is open
	if (event.key === 'Escape') {
		event.preventDefault();
		isOpen = false;
		navButtonRef.focus();
	} else if (
		event.key === 'Tab' &&
		!event.shiftKey &&
		document.activeElement === navLinks[navLinks.length - 1]
	) {
		// If Tab is pressed on the last item, close the menu
		isOpen = false;
	} else if (event.key === 'Tab' && event.shiftKey && document.activeElement === navLinks[0]) {
		// If Shift+Tab is pressed on the first item, close the menu
		isOpen = false;
	}
};

onMount(() => {
	if (!browser) return;

	document.addEventListener('click', handleClickOutside);
	document.addEventListener('keydown', handleKeyDown);

	// Collect all navigation links for keyboard navigation
	if (navItemsRef) {
		navLinks = Array.from(navItemsRef.querySelectorAll('a.nav-item-link'));
	}

	return () => {
		document.removeEventListener('click', handleClickOutside);
		document.removeEventListener('keydown', handleKeyDown);
	};
});
</script>

<!-- Product icon snippets - from Figma design -->
{#snippet searchIcon()}
	<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
		<path d="M15.2679 13.5133L19.7166 17.7157L20.2649 18.2705C20.4097 18.413 20.5258 18.5821 20.607 18.7684C20.686 18.9551 20.7278 19.1555 20.7298 19.3583C20.7289 19.664 20.6394 19.9629 20.472 20.2186C20.3046 20.4744 20.0665 20.6761 19.7867 20.7992C19.5985 20.8788 19.3967 20.9212 19.1924 20.9242C18.9877 20.9264 18.7848 20.8869 18.5959 20.808C18.4071 20.7308 18.2356 20.6167 18.0914 20.4724L17.1045 19.4987L13.0857 15.7349" stroke="currentColor" stroke-width="1.1" stroke-linejoin="round"/>
		<path d="M9.17 16.7723C10.6736 16.7723 12.1434 16.3265 13.3936 15.4911C14.6438 14.6558 15.6182 13.4685 16.1936 12.0793C16.769 10.6902 16.9195 9.16164 16.6262 7.68695C16.3328 6.21226 15.6088 4.85766 14.5456 3.79447C13.4824 2.73128 12.1278 2.00723 10.6531 1.7139C9.17843 1.42057 7.64987 1.57112 6.26075 2.14651C4.87162 2.72191 3.68431 3.69631 2.84897 4.94649C2.01362 6.19667 1.56776 7.66649 1.56776 9.17007C1.56776 11.1863 2.36871 13.12 3.7944 14.5457C5.2201 15.9714 7.15376 16.7723 9.17 16.7723Z" stroke="currentColor" stroke-width="1.1"/>
		<path d="M14.119 9.16774C14.118 10.4351 13.6309 11.6539 12.7582 12.5729C11.8854 13.4919 10.6934 14.0412 9.42779 14.1077C8.16214 14.1741 6.9192 13.7526 5.95501 12.9301C4.99082 12.1075 4.37881 10.9465 4.24506 9.68615C4.22778 9.51335 4.21913 9.34054 4.21913 9.16774C4.21224 7.88053 4.70714 6.64127 5.59883 5.71291C6.49051 4.78455 7.70882 4.24013 8.99526 4.19516C10.2817 4.1502 11.5351 4.60822 12.4894 5.47206C13.4437 6.3359 14.0239 7.53758 14.1069 8.82213C14.1156 8.93618 14.119 9.05196 14.119 9.16774Z" stroke="currentColor" stroke-width="1.1"/>
		<path d="M14.107 8.82293C13.3903 8.68311 12.6516 8.70343 11.9438 8.88242C11.2359 9.06142 10.5763 9.39467 10.0123 9.85832C9.44822 10.322 8.99364 10.9046 8.68104 11.5644C8.36843 12.2243 8.20555 12.9451 8.20403 13.6752C8.20196 13.7906 8.20599 13.9059 8.21612 14.0208C8.93334 14.162 9.67295 14.1425 10.3817 13.9638C11.0905 13.785 11.7509 13.4513 12.3153 12.9869C12.8798 12.5224 13.3343 11.9386 13.6462 11.2775C13.9581 10.6164 14.1196 9.89434 14.1191 9.16335C14.1191 9.05276 14.1156 8.93698 14.107 8.82293Z" stroke="currentColor" stroke-width="0.88"/>
		<path d="M10.1636 4.36734C9.44648 4.22744 8.70734 4.24786 7.99909 4.42715C7.29084 4.60644 6.631 4.94015 6.06686 5.40438C5.50271 5.86861 5.04823 6.45187 4.73596 7.11236C4.42368 7.77286 4.26136 8.49424 4.26061 9.22483C4.25854 9.34017 4.26258 9.45553 4.27271 9.57044C4.99044 9.71211 5.73064 9.69301 6.44011 9.51452C7.14958 9.33602 7.81069 9.00257 8.37593 8.53812C8.94116 8.07367 9.39648 7.48976 9.70916 6.82837C10.0218 6.16697 10.1841 5.44452 10.1843 4.71295C10.1843 4.59544 10.1722 4.48139 10.1636 4.36734Z" stroke="currentColor" stroke-width="0.88"/>
	</svg>
{/snippet}

{#snippet assistantIcon()}
	<svg width="22" height="22" viewBox="0 0 20.46 20.46" fill="none" xmlns="http://www.w3.org/2000/svg">
		<path d="M10.2281 19.9062C15.5731 19.9062 19.9062 15.5731 19.9062 10.2281C19.9062 4.88302 15.5731 0.55 10.2281 0.55C4.88302 0.55 0.55 4.88302 0.55 10.2281C0.55 15.5731 4.88302 19.9062 10.2281 19.9062Z" stroke="currentColor" stroke-width="1.1" stroke-linecap="round" stroke-linejoin="round"/>
		<path d="M10.228 17.2953C14.1311 17.2953 17.2952 14.1313 17.2952 10.2282C17.2952 6.32509 14.1311 3.16102 10.228 3.16102C6.32496 3.16102 3.16089 6.32509 3.16089 10.2282C3.16089 14.1313 6.32496 17.2953 10.228 17.2953Z" stroke="currentColor" stroke-width="1.1" stroke-linecap="round" stroke-linejoin="round"/>
		<mask id="mask_assistant" style="mask-type:luminance" maskUnits="userSpaceOnUse" x="3" y="3" width="15" height="15">
			<path d="M10.228 17.2953C14.1311 17.2953 17.2952 14.1313 17.2952 10.2282C17.2952 6.32509 14.1311 3.16102 10.228 3.16102C6.32494 3.16102 3.16087 6.32509 3.16087 10.2282C3.16087 14.1313 6.32494 17.2953 10.228 17.2953Z" fill="white"/>
		</mask>
		<g mask="url(#mask_assistant)">
			<path d="M-1.62666 8.40558C2.0209 8.40558 2.0209 6.5818 5.21252 6.5818C8.40413 6.5818 9.31602 9.31747 12.9636 9.31747C16.6111 9.31747 16.6111 7.49369 20.2587 7.49369M-1.62672 12.965C2.02085 12.965 2.02085 11.1413 5.21246 11.1413C8.40408 11.1413 9.31597 13.8769 12.9635 13.8769C16.6111 13.8769 16.6111 12.0531 20.2587 12.0531" stroke="currentColor" stroke-width="1.1" stroke-linecap="round" stroke-linejoin="round"/>
		</g>
	</svg>
{/snippet}

{#snippet newsIconLight()}
	<svg width="22" height="22" viewBox="4 5 20 18" fill="none" xmlns="http://www.w3.org/2000/svg">
		<g>
			<path d="M4.86377 8.60425L10.1824 9.81303C10.3637 9.85896 10.5499 9.89522 10.736 9.92423C10.8762 9.93874 11.0189 9.93874 11.3017 9.93874H15.4406C17.8001 9.93874 18.9799 9.93874 19.7124 10.664C20.4449 11.3893 20.4376 12.5763 20.4376 14.9358V16.3549C20.4376 18.7145 20.4376 19.8942 19.7124 20.6267C18.9871 21.3593 17.8001 21.352 15.4406 21.352H9.8681C7.50857 21.352 6.32881 21.352 5.59629 20.6267C4.86377 19.9015 4.87102 18.7145 4.87102 16.3549L4.86377 8.60425Z" fill="white" stroke="#18181A" stroke-width="1.1"/>
			<path d="M7.10718 13.0226H14.0867" stroke="#18181A" stroke-width="0.88" stroke-linecap="round" stroke-linejoin="round"/>
			<path d="M7.10718 15.4803H11.0671" stroke="#18181A" stroke-width="0.88" stroke-linecap="round" stroke-linejoin="round"/>
			<path d="M7.10718 17.9313H11.0671" stroke="#18181A" stroke-width="0.88" stroke-linecap="round" stroke-linejoin="round"/>
			<path d="M4.86377 7.82803C4.86319 7.54864 4.9174 7.27185 5.02333 7.01332C5.12943 6.75556 5.28553 6.52137 5.48263 6.32427C5.67973 6.12718 5.91391 5.97107 6.17167 5.86498C6.43005 5.75828 6.70684 5.70325 6.98639 5.703H11.2195C12.6942 5.703 13.4316 5.703 13.8788 6.15992C14.3261 6.61684 14.3382 7.35661 14.3382 8.81923V9.93856H6.98639C6.42572 9.93793 5.88801 9.71576 5.49043 9.32044C5.09284 8.92512 4.8676 8.38869 4.86377 7.82803Z" fill="white" stroke="#18181A" stroke-width="1.1"/>
			<path d="M23.1695 18.5668C23.0888 19.6236 22.6029 20.6083 21.8134 21.3154C21.0239 22.0224 19.9917 22.3971 18.9325 22.3612C17.8732 22.3254 16.8688 21.8817 16.1289 21.1228C15.389 20.3639 14.9709 19.3486 14.9619 18.2888C14.959 18.1443 14.9647 17.9998 14.9788 17.856C15.0244 17.3178 15.1773 16.7942 15.4285 16.3161C15.6775 15.8358 16.0194 15.4099 16.4345 15.0629C16.8495 14.716 17.3293 14.4549 17.846 14.295C18.361 14.1311 18.9035 14.072 19.4416 14.1209C19.8061 14.1542 20.1646 14.2355 20.5078 14.3627C21.3055 14.6594 21.9914 15.1965 22.4708 15.8998C22.9501 16.603 23.1994 17.4378 23.184 18.2888C23.1824 18.3774 23.1776 18.4701 23.1695 18.5668Z" fill="#EDC4AA" stroke="#18181A" stroke-width="1.1"/>
			<path d="M23.1839 18.2883C22.5355 18.0977 21.8502 18.0699 21.1886 18.2074C20.527 18.3449 19.9095 18.6434 19.3907 19.0764C18.9774 19.4238 18.6365 19.8492 18.3876 20.3283C18.1388 20.8074 17.9867 21.3308 17.9402 21.8687C17.9475 21.9645 17.9475 22.0607 17.9402 22.1564C18.5235 22.3255 19.137 22.3633 19.7366 22.267C20.3362 22.1707 20.907 21.9426 21.408 21.5994C21.9089 21.2561 22.3276 20.806 22.6338 20.2816C22.94 19.7571 23.1262 19.1713 23.179 18.5663C23.1766 18.4696 23.1814 18.3754 23.1839 18.2883Z" stroke="#18181A" stroke-width="0.66"/>
			<path d="M20.3578 14.3521C19.7747 14.1834 19.1615 14.146 18.5622 14.2425C17.9628 14.339 17.3924 14.5671 16.8917 14.9103C16.391 15.2536 15.9726 15.7035 15.6665 16.2277C15.3604 16.7519 15.1743 17.3374 15.1214 17.9422C15.1214 18.0389 15.1069 18.1331 15.1045 18.2274C15.6876 18.3965 16.3009 18.4344 16.9003 18.3382C17.4998 18.242 18.0705 18.0142 18.5714 17.6712C19.0723 17.3281 19.491 16.8784 19.7974 16.3542C20.1038 15.8301 20.2902 15.2446 20.3433 14.6398C20.3409 14.5431 20.3578 14.4464 20.3578 14.3521Z" stroke="#18181A" stroke-width="0.66"/>
		</g>
	</svg>
{/snippet}

{#snippet newsIconDark()}
	<svg width="22" height="22" viewBox="4 5 20 18" fill="none" xmlns="http://www.w3.org/2000/svg">
		<g>
			<path d="M4.86377 8.60425L10.1824 9.81303C10.3637 9.85896 10.5499 9.89522 10.736 9.92423C10.8762 9.93874 11.0189 9.93874 11.3017 9.93874H15.4406C17.8001 9.93874 18.9799 9.93874 19.7124 10.664C20.4449 11.3893 20.4376 12.5763 20.4376 14.9358V16.3549C20.4376 18.7145 20.4376 19.8942 19.7124 20.6267C18.9871 21.3593 17.8001 21.352 15.4406 21.352H9.8681C7.50857 21.352 6.32881 21.352 5.59629 20.6267C4.86377 19.9015 4.87102 18.7145 4.87102 16.3549L4.86377 8.60425Z" fill="white" stroke="#18181A" stroke-width="1.1"/>
			<path d="M7.10718 13.0226H14.0867" stroke="#18181A" stroke-width="0.88" stroke-linecap="round" stroke-linejoin="round"/>
			<path d="M7.10718 15.4803H11.0671" stroke="#18181A" stroke-width="0.88" stroke-linecap="round" stroke-linejoin="round"/>
			<path d="M7.10718 17.9313H11.0671" stroke="#18181A" stroke-width="0.88" stroke-linecap="round" stroke-linejoin="round"/>
			<path d="M4.86377 7.82803C4.86319 7.54864 4.9174 7.27185 5.02333 7.01332C5.12943 6.75556 5.28553 6.52137 5.48263 6.32427C5.67973 6.12718 5.91391 5.97107 6.17167 5.86498C6.43005 5.75828 6.70684 5.70325 6.98639 5.703H11.2195C12.6942 5.703 13.4316 5.703 13.8788 6.15992C14.3261 6.61684 14.3382 7.35661 14.3382 8.81923V9.93856H6.98639C6.42572 9.93793 5.88801 9.71576 5.49043 9.32044C5.09284 8.92512 4.8676 8.38869 4.86377 7.82803Z" fill="white" stroke="#18181A" stroke-width="1.1"/>
			<path d="M23.1695 18.5668C23.0888 19.6236 22.6029 20.6083 21.8134 21.3154C21.0239 22.0224 19.9917 22.3971 18.9325 22.3612C17.8732 22.3254 16.8688 21.8817 16.1289 21.1228C15.389 20.3639 14.9709 19.3486 14.9619 18.2888C14.959 18.1443 14.9647 17.9998 14.9788 17.856C15.0244 17.3178 15.1773 16.7942 15.4285 16.3161C15.6775 15.8358 16.0194 15.4099 16.4345 15.0629C16.8495 14.716 17.3293 14.4549 17.846 14.295C18.361 14.1311 18.9035 14.072 19.4416 14.1209C19.8061 14.1542 20.1646 14.2355 20.5078 14.3627C21.3055 14.6594 21.9914 15.1965 22.4708 15.8998C22.9501 16.603 23.1994 17.4378 23.184 18.2888C23.1824 18.3774 23.1776 18.4701 23.1695 18.5668Z" fill="#EDC4AA" stroke="#18181A" stroke-width="1.1"/>
			<path d="M23.1839 18.2883C22.5355 18.0977 21.8502 18.0699 21.1886 18.2074C20.527 18.3449 19.9095 18.6434 19.3907 19.0764C18.9774 19.4238 18.6365 19.8492 18.3876 20.3283C18.1388 20.8074 17.9867 21.3308 17.9402 21.8687C17.9475 21.9645 17.9475 22.0607 17.9402 22.1564C18.5235 22.3255 19.137 22.3633 19.7366 22.267C20.3362 22.1707 20.907 21.9426 21.408 21.5994C21.9089 21.2561 22.3276 20.806 22.6338 20.2816C22.94 19.7571 23.1262 19.1713 23.179 18.5663C23.1766 18.4696 23.1814 18.3754 23.1839 18.2883Z" stroke="#18181A" stroke-width="0.66"/>
			<path d="M20.3578 14.3521C19.7747 14.1834 19.1615 14.146 18.5622 14.2425C17.9628 14.339 17.3924 14.5671 16.8917 14.9103C16.391 15.2536 15.9726 15.7035 15.6665 16.2277C15.3604 16.7519 15.1743 17.3374 15.1214 17.9422C15.1214 18.0389 15.1069 18.1331 15.1045 18.2274C15.6876 18.3965 16.3009 18.4344 16.9003 18.3382C17.4998 18.242 18.0705 18.0142 18.5714 17.6712C19.0723 17.3281 19.491 16.8784 19.7974 16.3542C20.1038 15.8301 20.2902 15.2446 20.3433 14.6398C20.3409 14.5431 20.3578 14.4464 20.3578 14.3521Z" stroke="#18181A" stroke-width="0.66"/>
		</g>
	</svg>
{/snippet}

{#snippet translateIcon()}
	<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
		<path d="M3.25018 15.1425C3.25254 15.7497 3.4948 16.3313 3.92417 16.7607C4.35354 17.1901 4.93521 17.4323 5.54243 17.4347H6.9639" stroke="currentColor" stroke-width="0.88" stroke-linecap="round" stroke-linejoin="round"/>
		<path d="M7.63322 17.4339L6.41098 15.8916" stroke="currentColor" stroke-width="0.88" stroke-linecap="round" stroke-linejoin="round"/>
		<path d="M7.63322 17.4342L6.41098 18.9765" stroke="currentColor" stroke-width="0.88" stroke-linecap="round" stroke-linejoin="round"/>
		<path d="M18.2058 6.04388C18.2058 5.43395 17.9637 4.84897 17.5326 4.41747C17.1015 3.98598 16.5168 3.74327 15.9068 3.74268H14.4966" stroke="currentColor" stroke-width="0.88" stroke-linecap="round" stroke-linejoin="round"/>
		<path d="M13.825 3.74268L15.045 5.28726" stroke="currentColor" stroke-width="0.88" stroke-linecap="round" stroke-linejoin="round"/>
		<path d="M13.825 3.74563L15.045 2.20105" stroke="currentColor" stroke-width="0.88" stroke-linecap="round" stroke-linejoin="round"/>
		<path fill-rule="evenodd" clip-rule="evenodd" d="M19.9238 11.3987V16.6279C19.9241 17.0078 19.8495 17.384 19.7043 17.735C19.559 18.086 19.346 18.405 19.0774 18.6736C18.8088 18.9422 18.4898 19.1552 18.1388 19.3005C17.7878 19.4457 17.4116 19.5203 17.0317 19.52H13.1716C12.4048 19.5194 11.6695 19.2145 11.1273 18.6722C10.585 18.13 10.2801 17.3947 10.2795 16.6279V11.3987C10.2795 10.6315 10.5841 9.89561 11.1265 9.35286C11.6688 8.81011 12.4044 8.50489 13.1716 8.50427H17.0317C17.7989 8.50489 18.5345 8.81011 19.0769 9.35286C19.6192 9.89561 19.9238 10.6315 19.9238 11.3987Z" stroke="currentColor" stroke-width="1.1"/>
		<path d="M13.1693 16.684V12.684C13.1693 12.1706 13.3732 11.6782 13.7362 11.3152C14.0993 10.9521 14.5917 10.7482 15.1051 10.7482C15.6185 10.7482 16.1109 10.9521 16.474 11.3152C16.837 11.6782 17.041 12.1706 17.041 12.684V16.684" stroke="currentColor" stroke-width="0.88" stroke-linecap="round" stroke-linejoin="round"/>
		<path d="M13.1716 14.4379H17.0433" stroke="currentColor" stroke-width="0.88" stroke-linecap="round" stroke-linejoin="round"/>
		<path d="M11.7092 8.97678V5.59415H11.7022C11.7015 4.8273 11.3966 4.09204 10.8544 3.54979C10.3121 3.00755 9.57689 2.70264 8.81004 2.70203H4.96165C4.58176 2.70172 4.20555 2.77632 3.85452 2.92155C3.50349 3.06679 3.18454 3.27981 2.91592 3.54843C2.64731 3.81705 2.43428 4.13599 2.28905 4.48702C2.14381 4.83805 2.06921 5.21427 2.06952 5.59415V10.8233C2.06952 11.5897 2.37351 12.3249 2.91481 12.8675C3.45612 13.4101 4.19053 13.7159 4.95698 13.7177H8.81703C9.28835 13.7174 9.74773 13.602 10.1577 13.3873" stroke="currentColor" stroke-width="1.1" stroke-linejoin="round"/>
		<path d="M6.82056 4.93579L8.7704 9.40225L7.55991 9.34627" stroke="currentColor" stroke-width="0.88" stroke-linecap="round" stroke-linejoin="round"/>
		<path d="M9.15294 5.50354L4.38327 6.12861" stroke="currentColor" stroke-width="0.88" stroke-linecap="round" stroke-linejoin="round"/>
		<path d="M9.03393 11.1889H6.09517C5.67392 11.1889 5.26991 11.0216 4.97204 10.7237C4.67417 10.4258 4.50684 10.0218 4.50684 9.60059" stroke="currentColor" stroke-width="0.88" stroke-linecap="round" stroke-linejoin="round"/>
		<path d="M9.39544 7.2677L4.6351 7.89277" stroke="currentColor" stroke-width="0.88" stroke-linecap="round" stroke-linejoin="round"/>
	</svg>
{/snippet}

{#snippet summarizeIcon()}
	<svg width="22" height="22" viewBox="0 0 17.6 18.3" fill="none" xmlns="http://www.w3.org/2000/svg">
		<path d="M14.0395 2.76917C14.0395 2.18061 13.8057 1.61616 13.3895 1.19998C12.9734 0.783805 12.4089 0.55 11.8204 0.55H2.76918C2.18062 0.55 1.61615 0.783805 1.19998 1.19998C0.783803 1.61616 0.55 2.18061 0.55 2.76917V14.1837C0.55 14.7723 0.783803 15.3368 1.19998 15.7529C1.61615 16.1691 2.18062 16.4029 2.76918 16.4029H3.75694" stroke="currentColor" stroke-width="1.1"/>
		<path d="M14.8142 2.4675H5.76298C5.17764 2.46995 4.61696 2.70356 4.20306 3.11746C3.78916 3.53136 3.55556 4.09203 3.55311 4.67737V15.5174C3.55311 16.1059 3.78692 16.6704 4.20309 17.0866C4.61927 17.5027 5.18374 17.7365 5.7723 17.7365H14.8234C15.412 17.7365 15.9765 17.5027 16.3926 17.0866C16.8088 16.6704 17.0426 16.1059 17.0426 15.5174V4.67737C17.0414 4.38594 16.9828 4.09761 16.8701 3.82883C16.7575 3.56006 16.593 3.3161 16.3861 3.1109C16.1791 2.90569 15.9338 2.74325 15.6641 2.63286C15.3944 2.52246 15.1056 2.46628 14.8142 2.4675Z" stroke="currentColor" stroke-width="1.1"/>
		<path d="M8.79167 6.92979H14.5164" stroke="currentColor" stroke-width="0.88" stroke-linecap="round" stroke-linejoin="round"/>
		<path d="M8.79167 10.1063H14.5164" stroke="currentColor" stroke-width="0.88" stroke-linecap="round" stroke-linejoin="round"/>
		<path d="M8.79167 13.2849H14.5164" stroke="currentColor" stroke-width="0.88" stroke-linecap="round" stroke-linejoin="round"/>
		<path d="M6.68645 7.71452C6.8415 7.71452 6.99307 7.66855 7.12199 7.58241C7.2509 7.49627 7.35138 7.37384 7.41071 7.2306C7.47005 7.08735 7.48557 6.92973 7.45532 6.77767C7.42507 6.6256 7.3504 6.48592 7.24076 6.37629C7.13113 6.26665 6.99146 6.19199 6.83939 6.16174C6.68732 6.1315 6.52969 6.14702 6.38645 6.20635C6.24321 6.26569 6.12079 6.36616 6.03466 6.49508C5.94852 6.62399 5.90253 6.77556 5.90253 6.9306C5.90253 7.13851 5.98512 7.33791 6.13214 7.48492C6.27915 7.63193 6.47854 7.71452 6.68645 7.71452Z" fill="currentColor"/>
		<path d="M6.68645 10.8921C6.8415 10.8921 6.99307 10.8461 7.12199 10.7599C7.2509 10.6738 7.35138 10.5514 7.41071 10.4081C7.47005 10.2649 7.48557 10.1073 7.45532 9.95521C7.42507 9.80314 7.3504 9.66346 7.24076 9.55383C7.13113 9.44419 6.99146 9.36953 6.83939 9.33928C6.68732 9.30903 6.52969 9.32456 6.38645 9.38389C6.24321 9.44323 6.12079 9.5437 6.03466 9.67262C5.94852 9.80153 5.90253 9.9531 5.90253 10.1081C5.90253 10.3161 5.98512 10.5154 6.13214 10.6625C6.27915 10.8095 6.47854 10.8921 6.68645 10.8921Z" fill="currentColor"/>
		<path d="M6.68647 14.0651C6.84075 14.0651 6.99158 14.0193 7.11986 13.9336C7.24813 13.8479 7.34812 13.7261 7.40716 13.5835C7.4662 13.441 7.48165 13.2842 7.45155 13.1329C7.42145 12.9815 7.34714 12.8425 7.23805 12.7335C7.12896 12.6244 6.98997 12.5501 6.83866 12.52C6.68734 12.4899 6.53049 12.5053 6.38795 12.5644C6.24542 12.6234 6.12361 12.7234 6.0379 12.8517C5.95218 12.9799 5.90642 13.1308 5.90642 13.285C5.90642 13.3875 5.92662 13.4889 5.96582 13.5835C6.00502 13.6782 6.06246 13.7642 6.1349 13.8366C6.20733 13.909 6.29331 13.9665 6.38795 14.0057C6.48259 14.0449 6.58404 14.0651 6.68647 14.0651Z" fill="currentColor"/>
	</svg>
{/snippet}

{#snippet smallwebIcon()}
	<svg width="22" height="22" viewBox="0 0 20.46 20.46" fill="none" xmlns="http://www.w3.org/2000/svg">
		<circle cx="10.23" cy="10.23" r="9.68" stroke="currentColor" stroke-width="1.1"/>
		<path d="M4.14664 11.3137C4.0884 10.9145 4.05855 10.5094 4.05855 10.0993C4.05855 6.41396 6.46962 3.12952 10.2299 1.00212C13.9902 3.12952 16.4014 6.41397 16.4014 10.0994C16.4014 10.5094 16.3715 10.9146 16.3133 11.3137" stroke="currentColor" stroke-width="0.88"/>
		<path d="M6.92649 12.7955C6.91848 12.6418 6.91442 12.4872 6.91442 12.3316C6.91442 9.55081 8.20975 7.07258 10.2299 5.46738C12.2501 7.07258 13.5455 9.55082 13.5455 12.3316C13.5455 12.4872 13.5414 12.6418 13.5334 12.7955" stroke="currentColor" stroke-width="0.88"/>
		<path fill-rule="evenodd" clip-rule="evenodd" d="M10.2276 19.9103C10.2293 19.8403 10.23 19.7701 10.23 19.6997C10.23 14.8604 6.30693 10.9373 1.46759 10.9373C1.16762 10.9373 0.871166 10.9524 0.578951 10.9818C0.962404 15.9759 5.13556 19.909 10.2276 19.9103Z" stroke="currentColor" stroke-width="0.88" stroke-linejoin="round"/>
		<path fill-rule="evenodd" clip-rule="evenodd" d="M19.8814 10.9818C19.589 10.9524 19.2925 10.9373 18.9924 10.9373C14.1531 10.9373 10.23 14.8604 10.23 19.6997C10.23 19.7701 10.2308 19.8403 10.2325 19.9103C15.3246 19.9091 19.4979 15.976 19.8814 10.9818Z" stroke="currentColor" stroke-width="0.88" stroke-linejoin="round"/>
	</svg>
{/snippet}

{#snippet fastgptIcon()}
	<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
		<g clip-path="url(#clip_fastgpt)">
			<path d="M8.29265 9.92913C8.50753 10.0135 8.63117 10.241 8.58587 10.4686L8.12407 12.7883C8.09777 12.9204 8.01735 13.0352 7.90254 13.1044C7.78774 13.1736 7.64921 13.1909 7.52106 13.1519L7.52084 13.1519C7.52074 13.1519 7.5206 13.1518 7.52039 13.1517C7.51988 13.1516 7.51894 13.1513 7.51783 13.151C7.51563 13.1503 7.51224 13.1493 7.50781 13.1479C7.49887 13.1452 7.48551 13.1413 7.46818 13.1361C7.43341 13.1257 7.38266 13.1106 7.31934 13.0921C7.19259 13.0551 7.01594 13.0044 6.81655 12.9499C6.41693 12.8407 5.9436 12.7211 5.59692 12.6613C5.58886 12.6626 5.5652 12.6673 5.52231 12.6848C5.44876 12.7147 5.35211 12.7691 5.23446 12.8522C4.99941 13.0183 4.73383 13.2605 4.47658 13.5215C4.22208 13.7796 3.98819 14.0433 3.81718 14.2436C3.73194 14.3435 3.66295 14.4269 3.61554 14.485C3.59187 14.5139 3.57357 14.5366 3.56141 14.5517C3.55535 14.5593 3.55077 14.565 3.54783 14.5687C3.54636 14.5705 3.54528 14.5719 3.54463 14.5728L3.54399 14.5737L3.51611 14.6057C3.44818 14.6776 3.35945 14.7267 3.26199 14.7456L2.85175 14.825C2.70745 14.853 2.55836 14.8123 2.448 14.7146C2.33765 14.6169 2.27848 14.4732 2.28764 14.3256L2.76185 14.3556L2.28752 14.3253L2.28762 14.325C2.28764 14.3247 2.2877 14.3245 2.28771 14.3242L2.28836 14.3153C2.28876 14.3097 2.28932 14.302 2.29008 14.2924C2.29161 14.2732 2.29386 14.246 2.29723 14.2115C2.30398 14.1426 2.31493 14.0445 2.33205 13.9231C2.36622 13.6809 2.42532 13.3436 2.52535 12.9589C2.71712 12.2213 3.0689 11.2725 3.71634 10.4911L3.77986 10.416C4.56058 9.51423 5.76793 9.44568 6.64432 9.53966C7.09873 9.5884 7.50759 9.68495 7.8013 9.76843C7.94884 9.81036 8.06913 9.84958 8.15358 9.87865C8.19581 9.89319 8.2292 9.90526 8.2527 9.91395C8.26447 9.9183 8.27378 9.92189 8.28048 9.92445C8.28382 9.92572 8.28659 9.92667 8.28863 9.92745C8.28961 9.92784 8.29041 9.92824 8.29108 9.9285L8.29242 9.92891C8.29254 9.92898 8.29166 9.93152 8.18322 10.2115L8.29265 9.92913ZM7.54333 10.6887C7.28421 10.615 6.93004 10.5321 6.54401 10.4907C5.73953 10.4044 4.95598 10.5137 4.49649 11.0443L4.44539 11.1047C3.92473 11.7334 3.61913 12.5298 3.44454 13.2013C3.44165 13.2124 3.43897 13.2236 3.43614 13.2346C3.54939 13.1102 3.67285 12.9786 3.80195 12.8477C4.07489 12.5708 4.38609 12.2831 4.68829 12.0695C4.83925 11.9629 5.00135 11.865 5.16593 11.798C5.32496 11.7333 5.52887 11.68 5.74412 11.7166L5.89818 11.7447C6.26873 11.8167 6.70951 11.9299 7.06529 12.0271C7.14567 12.0491 7.22237 12.0706 7.29385 12.0907L7.57138 10.6968C7.56217 10.6942 7.55282 10.6914 7.54333 10.6887Z" fill="currentColor"/>
			<path d="M12.4284 13.8774C12.3334 13.6659 12.1012 13.5536 11.8777 13.6111L9.60034 14.1974C9.47067 14.2308 9.361 14.3176 9.29836 14.4367C9.23572 14.5557 9.22591 14.6958 9.2713 14.8226L9.2713 14.8228C9.27134 14.8229 9.27146 14.823 9.27154 14.8232C9.27172 14.8237 9.27199 14.8247 9.27238 14.8258C9.27315 14.8279 9.27439 14.8313 9.27595 14.8357C9.2791 14.8445 9.28375 14.8577 9.2898 14.8749C9.30193 14.9093 9.31961 14.9595 9.34128 15.0221C9.38467 15.1476 9.44426 15.3225 9.50881 15.52C9.6382 15.9159 9.78184 16.3853 9.85937 16.7306C9.85856 16.7387 9.85511 16.7628 9.84006 16.8068C9.81423 16.8823 9.76537 16.9823 9.68907 17.1049C9.53665 17.3499 9.31028 17.6296 9.06489 17.9018C8.82213 18.1712 8.57282 18.4202 8.38306 18.6026C8.28848 18.6935 8.20931 18.7672 8.15423 18.8179C8.12673 18.8433 8.10521 18.8628 8.09081 18.8759C8.08363 18.8824 8.07825 18.8873 8.07474 18.8904C8.07298 18.892 8.07164 18.8931 8.07085 18.8938L8.06998 18.8945L8.03962 18.9242C7.97191 18.9963 7.92784 19.0881 7.91421 19.187L7.85703 19.6035C7.83688 19.75 7.8851 19.8977 7.98785 20.0035C8.09061 20.1092 8.23627 20.1611 8.38224 20.1441L8.32754 19.6691L8.38258 20.1443L8.38291 20.1441C8.38313 20.1441 8.38339 20.144 8.38368 20.144L8.39248 20.1429C8.39797 20.1422 8.40555 20.1412 8.41505 20.1399C8.43405 20.1374 8.46095 20.1337 8.49494 20.1285C8.56295 20.1181 8.65978 20.1019 8.77926 20.0783C9.0178 20.0312 9.34934 19.9541 9.72582 19.8333C10.4476 19.6017 11.3705 19.1982 12.1117 18.5064L12.183 18.4386C13.0366 17.6065 13.041 16.3894 12.9016 15.5135C12.8294 15.0594 12.712 14.6536 12.6137 14.3628C12.5644 14.2167 12.5191 14.0979 12.4858 14.0145C12.4692 13.9729 12.4554 13.9399 12.4456 13.9168C12.4406 13.9052 12.4366 13.896 12.4337 13.8894C12.4323 13.8861 12.4312 13.8834 12.4303 13.8814C12.4299 13.8804 12.4294 13.8796 12.4291 13.879L12.4286 13.8776C12.4286 13.8775 12.4261 13.8785 12.154 14.0023L12.4284 13.8774ZM11.7142 14.6705C11.8009 14.927 11.9019 15.2786 11.9633 15.6644C12.0913 16.4684 12.0241 17.2617 11.5218 17.7514L11.4646 17.806C10.8681 18.3623 10.094 18.7114 9.43694 18.9222C9.42604 18.9257 9.41512 18.929 9.4043 18.9324C9.52182 18.812 9.64582 18.681 9.76896 18.5444C10.0293 18.2555 10.2984 17.9276 10.4944 17.6126C10.5923 17.4553 10.6809 17.2872 10.7386 17.1183C10.7945 16.955 10.8367 16.7473 10.7891 16.5329L10.753 16.3795C10.662 16.0109 10.5265 15.5739 10.4113 15.2214C10.3853 15.1418 10.36 15.0658 10.3362 14.9951L11.7047 14.6427C11.7078 14.6519 11.711 14.6611 11.7142 14.6705Z" fill="currentColor"/>
			<mask id="mask_fastgpt" style="mask-type:luminance" maskUnits="userSpaceOnUse" x="7" y="3" width="11" height="13">
				<path d="M15.6995 6.26109C15.4317 7.45047 14.8926 8.81272 13.8285 9.9416C12.1857 11.6844 10.8138 12.5195 9.93602 12.9179C9.79734 12.9809 9.66904 13.0319 9.5539 13.0756L9.26148 12.7964C9.2988 12.6785 9.34342 12.5473 9.39851 12.4047C9.74766 11.5015 10.504 10.0788 12.1468 8.33591C13.2108 7.20721 14.5336 6.59289 15.6995 6.26109Z" fill="white" stroke="white" stroke-width="4.08534"/>
			</mask>
			<g mask="url(#mask_fastgpt)">
				<path d="M19.3 6.39425C20.1401 5.50302 20.0573 3.90927 18.9304 2.83333C17.8035 1.75741 16.2177 1.7581 15.3777 2.64932C14.5376 3.54054 14.6204 5.1343 15.7473 6.21023C16.8742 7.28617 18.4599 7.28547 19.3 6.39425ZM19.9894 7.05249C18.7104 8.40933 16.5136 8.25973 15.0935 6.90385C13.6734 5.54797 13.4093 3.34793 14.6883 1.99108C15.9672 0.63423 18.1641 0.783845 19.5842 2.13971C21.0043 3.4956 21.2684 5.69563 19.9894 7.05249Z" fill="currentColor"/>
			</g>
			<path d="M14.9614 11.0233C16.3653 9.53396 17.0018 7.75349 17.285 6.32828C17.4263 5.61745 17.4783 5.00146 17.495 4.56499C17.498 4.48779 17.4996 4.41627 17.5007 4.35096C17.4359 4.35545 17.3651 4.36095 17.2887 4.36799C16.8565 4.4078 16.2481 4.4925 15.5502 4.67191C14.151 5.03163 12.4178 5.76505 11.014 7.25439C9.24014 9.13622 8.37074 10.7308 7.94387 11.8351C7.73021 12.3879 7.62655 12.8203 7.5762 13.1072C7.56144 13.1914 7.55145 13.2632 7.54441 13.3218L8.00024 13.7571L8.32199 14.0643L8.77844 14.5001L9.12389 14.8299C9.18174 14.8197 9.25245 14.8059 9.33516 14.7866C9.61722 14.7209 10.0408 14.594 10.578 14.3501C11.6513 13.863 13.1876 12.9052 14.9614 11.0233ZM7.52857 13.5131L7.52866 13.5121L7.52852 13.5109L7.52857 13.5131ZM15.6509 11.6816C13.7974 13.6479 12.1611 14.6807 10.9688 15.2218C10.3732 15.4922 9.89056 15.6389 9.54969 15.7183C9.37933 15.758 9.24455 15.7809 9.14907 15.7939C9.10135 15.8005 9.06338 15.8045 9.03575 15.807C9.02197 15.8083 9.01074 15.8092 9.00214 15.8098C8.99784 15.8101 8.9942 15.8102 8.99122 15.8104L8.98725 15.8108L8.9856 15.8109L8.96109 15.3333L8.98427 15.8109C8.85476 15.8173 8.7283 15.7699 8.63421 15.6801L8.15426 15.2218L7.65913 14.7491L7.30547 14.4114L6.7266 13.8588C6.63252 13.7689 6.57889 13.6443 6.57834 13.5138L7.05347 13.512C6.60114 13.5138 6.57834 13.5138 6.57834 13.5138L6.5783 13.5125L6.57837 13.5108L6.57849 13.5068C6.5785 13.5038 6.57845 13.5001 6.57853 13.4958C6.57867 13.4871 6.57898 13.4758 6.57951 13.4619C6.58057 13.434 6.58258 13.3956 6.58654 13.3473C6.59448 13.2506 6.61004 13.114 6.64045 12.9407C6.70129 12.5939 6.82152 12.1011 7.05838 11.4883C7.53257 10.2614 8.47112 8.56256 10.3246 6.59622C11.8909 4.93462 13.8071 4.13292 15.3147 3.74532C16.0702 3.55109 16.7295 3.45909 17.2018 3.41559C17.4381 3.39382 17.6283 3.38417 17.7611 3.37996C17.8275 3.37785 17.8796 3.37708 17.916 3.37688C17.9341 3.37678 17.9484 3.3768 17.9586 3.37687C17.9637 3.3769 17.9677 3.37695 17.9707 3.37699L17.9745 3.37711L17.9763 3.37707C17.9763 3.37707 17.9766 3.37714 17.9686 3.81915L17.9763 3.37707C18.2222 3.38166 18.4243 3.57447 18.4418 3.82136L17.968 3.85519C18.4365 3.82169 18.4418 3.82136 18.4418 3.82136L18.442 3.82347L18.4423 3.82724C18.4425 3.83027 18.4428 3.83435 18.4431 3.83945C18.4437 3.84967 18.4445 3.86403 18.4453 3.8823C18.447 3.91888 18.449 3.97131 18.4504 4.03813C18.4532 4.17177 18.4537 4.36343 18.4445 4.60212C18.4262 5.07905 18.3697 5.74658 18.2168 6.51617C17.9116 8.05186 17.2171 10.02 15.6509 11.6816Z" fill="currentColor"/>
			<path d="M14.1697 9.13751C14.558 8.72557 14.541 8.07465 14.1316 7.6837C13.7221 7.29276 13.0752 7.30979 12.6869 7.72175C12.2987 8.13371 12.3159 8.78463 12.7253 9.17555C13.1348 9.56642 13.7814 9.54938 14.1697 9.13751ZM14.8592 9.79574C14.1098 10.5907 12.8618 10.6236 12.0715 9.86917C11.2813 9.11469 11.2482 7.85857 11.9975 7.06351C12.7469 6.26846 13.9951 6.23558 14.7854 6.99008C15.5756 7.74458 15.6086 9.00071 14.8592 9.79574Z" fill="currentColor"/>
			<path d="M10.2838 12.0699C10.4613 12.2686 10.5142 12.5504 10.4217 12.8004L10.3997 12.8534L10.3981 12.8569C10.1243 13.4357 9.60387 14.3346 8.69965 15.2515C7.47561 16.4926 6.33172 17.0628 5.93388 17.2454C5.75773 17.3262 5.55032 17.2914 5.40976 17.1574C5.26925 17.0233 5.22364 16.8168 5.2944 16.6355C5.45445 16.2253 5.96008 15.0456 7.12742 13.7504L7.20826 13.6618C8.04321 12.7581 8.87121 12.2132 9.41373 11.917C9.41484 11.9164 9.416 11.9159 9.41711 11.9153C9.68879 11.7698 10.0216 11.8165 10.2439 12.0287L10.2838 12.0699ZM9.08864 13.254C8.72564 13.5192 8.31659 13.8666 7.90417 14.3131L7.83138 14.3928C7.47764 14.7853 7.19139 15.1652 6.96191 15.51C7.29205 15.2612 7.65419 14.9539 8.02513 14.5778C8.48337 14.1131 8.83039 13.6552 9.08864 13.254Z" fill="currentColor"/>
		</g>
		<defs>
			<clipPath id="clip_fastgpt">
				<path d="M0 11C0 6.30885 0 3.96327 1.23988 2.34743C1.55908 1.93144 1.93144 1.55908 2.34743 1.23988C3.96327 0 6.30885 0 11 0C15.6912 0 18.0367 0 19.6526 1.23988C20.0686 1.55908 20.4409 1.93144 20.7601 2.34743C22 3.96327 22 6.30885 22 11C22 15.6912 22 18.0367 20.7601 19.6526C20.4409 20.0686 20.0686 20.4409 19.6526 20.7601C18.0367 22 15.6912 22 11 22C6.30885 22 3.96327 22 2.34743 20.7601C1.93144 20.4409 1.55908 20.0686 1.23988 19.6526C0 18.0367 0 15.6912 0 11Z" fill="white"/>
			</clipPath>
		</defs>
	</svg>
{/snippet}

<div class="app-menu-dropdown relative flex" class:is-open={isOpen}>
	<Tooltip text={s('app_navigation.tooltip') || 'Kagi Apps'}>
		<button
			bind:this={navButtonRef}
			onclick={toggleMenu}
			aria-label={s('app_navigation.open_navigation') || 'Open app navigation'}
			class="app-menu-button flex size-8 cursor-pointer items-center justify-center rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500"
			class:app-menu-button--selected={isOpen}
			aria-haspopup="true"
			aria-expanded={isOpen}
		>
			<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" class="text-gray-600 dark:text-gray-400">
				<path d="M4 5C4 4.73478 4.10536 4.48043 4.29289 4.29289C4.48043 4.10536 4.73478 4 5 4H9C9.26522 4 9.51957 4.10536 9.70711 4.29289C9.89464 4.48043 10 4.73478 10 5V9C10 9.26522 9.89464 9.51957 9.70711 9.70711C9.51957 9.89464 9.26522 10 9 10H5C4.73478 10 4.48043 9.89464 4.29289 9.70711C4.10536 9.51957 4 9.26522 4 9V5Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M14 5C14 4.73478 14.1054 4.48043 14.2929 4.29289C14.4804 4.10536 14.7348 4 15 4H19C19.2652 4 19.5196 4.10536 19.7071 4.29289C19.8946 4.48043 20 4.73478 20 5V9C20 9.26522 19.8946 9.51957 19.7071 9.70711C19.5196 9.89464 19.2652 10 19 10H15C14.7348 10 14.4804 9.89464 14.2929 9.70711C14.1054 9.51957 14 9.26522 14 9V5Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M4 15C4 14.7348 4.10536 14.4804 4.29289 14.2929C4.48043 14.1054 4.73478 14 5 14H9C9.26522 14 9.51957 14.1054 9.70711 14.2929C9.89464 14.4804 10 14.7348 10 15V19C10 19.2652 9.89464 19.5196 9.70711 19.7071C9.51957 19.8946 9.26522 20 9 20H5C4.73478 20 4.48043 19.8946 4.29289 19.7071C4.10536 19.5196 4 19.2652 4 19V15Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M14 15C14 14.7348 14.1054 14.4804 14.2929 14.2929C14.4804 14.1054 14.7348 14 15 14H19C19.2652 14 19.5196 14.1054 19.7071 14.2929C19.8946 14.4804 20 14.7348 20 15V19C20 19.2652 19.8946 19.5196 19.7071 19.7071C19.5196 19.8946 19.2652 20 19 20H15C14.7348 20 14.4804 19.8946 14.2929 19.7071C14.1054 19.5196 14 19.2652 14 19V15Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>
		</button>
	</Tooltip>

	<div class="app-menu-panel" role="menu">
		<div class="app-menu-items" bind:this={navItemsRef}>
			{#each menuItems as item}
				{#if item.id === 'divider'}
					<div class="app-menu-divider" aria-hidden="true"></div>
				{:else}
					<a
						class="nav-item-link app-menu-item"
						class:app-menu-item--active={item.active}
						href={item.href}
						role="menuitem"
						tabindex="0"
					>
						<span class="app-menu-icon">
							{#if item.id === 'search'}
								{@render searchIcon()}
							{:else if item.id === 'assistant'}
								{@render assistantIcon()}
							{:else if item.id === 'news'}
								{#if themeSettings.isDark}
									{@render newsIconDark()}
								{:else}
									{@render newsIconLight()}
								{/if}
							{:else if item.id === 'translate'}
								{@render translateIcon()}
							{:else if item.id === 'summarize'}
								{@render summarizeIcon()}
							{:else if item.id === 'smallweb'}
								{@render smallwebIcon()}
							{:else if item.id === 'fastgpt'}
								{@render fastgptIcon()}
							{/if}
						</span>
						<span class="app-menu-label" class:app-menu-label--active={item.active}>
							{s(item.labelKey ?? '') || item.id}
						</span>
					</a>
				{/if}
			{/each}
		</div>
	</div>
</div>

<style>
	/* Dropdown container */
	.app-menu-dropdown {
		font-size: 0.875rem;
	}

	/* Button selected state when dropdown is open */
	.app-menu-button--selected {
		background-color: rgb(243 244 246); /* gray-100 */
	}

	:global(.dark) .app-menu-button--selected {
		background-color: rgb(31 41 55); /* gray-800 */
	}

	/* Dropdown panel */
	.app-menu-panel {
		background-color: white;
		border: 1px solid rgb(229 231 235); /* gray-200 */
		border-radius: 12px;
		box-shadow: 0 4px 20px 0 rgba(0, 0, 0, 0.1);
		display: none;
		flex-direction: column;
		padding: 8px;
		position: absolute;
		top: calc(100% + 5px);
		inset-inline-end: 0;
		z-index: var(--z-index-modal);
		min-width: 209px;
	}

	:global(.dark) .app-menu-panel {
		background-color: #23232f; /* modal-bg - matches design spec */
		border-color: #454553; /* primary-100 - matches design spec */
	}

	.app-menu-dropdown.is-open .app-menu-panel {
		display: flex;
	}

	/* Menu items container */
	.app-menu-items {
		display: flex;
		flex-direction: column;
		gap: 8px;
	}

	/* Individual menu item */
	.app-menu-item {
		align-items: center;
		color: rgb(55 65 81); /* gray-700 */
		cursor: pointer;
		display: flex;
		gap: 6px;
		height: 32px;
		padding: 0 4px;
		border-radius: 6px;
		text-decoration: none;
		width: 193px;
	}

	:global(.dark) .app-menu-item {
		color: #e8e8f0; /* matches design spec for dark mode */
	}

	.app-menu-item:hover {
		background-color: rgb(243 244 246); /* gray-100 */
	}

	:global(.dark) .app-menu-item:hover {
		background-color: rgb(55 65 81); /* gray-700 */
	}

	.app-menu-item:focus {
		outline: none;
		background-color: rgb(243 244 246); /* gray-100 */
	}

	:global(.dark) .app-menu-item:focus {
		background-color: rgb(55 65 81); /* gray-700 */
	}

	/* Active menu item - purple background */
	.app-menu-item--active {
		background-color: rgba(201, 193, 255, 0.3);
	}

	:global(.dark) .app-menu-item--active {
		background-color: rgba(201, 193, 255, 0.3);
	}

	.app-menu-item--active:hover {
		background-color: rgba(201, 193, 255, 0.4);
	}

	:global(.dark) .app-menu-item--active:hover {
		background-color: rgba(201, 193, 255, 0.4);
	}

	/* Icon container */
	.app-menu-icon {
		display: flex;
		align-items: center;
		justify-content: center;
		width: 32px;
		height: 32px;
		padding: 4px;
		border-radius: 4px;
		flex-shrink: 0;
	}

	.app-menu-icon :global(svg) {
		width: 22px;
		height: 22px;
	}

	/* Menu label */
	.app-menu-label {
		font-size: 14px;
		font-weight: 400;
		line-height: 20px;
		color: rgb(55 65 81); /* gray-700 */
	}

	:global(.dark) .app-menu-label {
		color: #e8e8f0; /* matches design spec for dark mode */
	}

	/* Active label - bolder text */
	.app-menu-label--active {
		font-weight: 500;
		color: rgb(99 102 241); /* indigo-500 */
	}

	:global(.dark) .app-menu-label--active {
		color: white;
	}

	/* Divider */
	.app-menu-divider {
		height: 1px;
		background-color: rgb(229 231 235); /* gray-200 */
		margin: 0;
		width: 100%;
	}

	:global(.dark) .app-menu-divider {
		background-color: #454553; /* primary-100 - matches design spec */
	}
</style>
